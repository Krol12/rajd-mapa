<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mapa Rajdu</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<style>
  #map { height: 100vh; }

  /* Menu dni */
  .day-menu { 
    position: absolute; 
    top: 10px; 
    left: 50%; 
    transform: translateX(-50%); 
    z-index: 1000; 
    background: white; 
    padding: 5px; 
    border-radius: 8px; 
    box-shadow: 0 2px 6px rgba(0,0,0,0.3);
  }
  .day-menu button { 
    margin: 2px; 
    padding: 8px 14px; 
    font-size: 16px; 
    border: none; 
    border-radius: 5px;
    background-color: #f0f0f0;
    cursor: pointer;
    transition: 0.2s;
  }
  .day-menu button:hover { background-color: #d0e0ff; }
  .day-menu button.active { background-color: #007bff; color: white; }

  /* Kompas */
  .compass { 
    position: absolute; 
    bottom: 20px; 
    left: 50%; 
    width: 80px;
    height: 80px;
    transform: translateX(-50%);
    z-index: 1000; 
  }
  .compass svg {
    width: 100%;
    height: 100%;
    transform-origin: 50% 50%;
    transition: transform 0.2s;
  }
  .compass circle {
    fill: rgba(255,255,255,0.8);
    stroke: #333;
    stroke-width: 4;
  }
</style>
</head>
<body>
<div class="day-menu">
  <button onclick="showDay(1)">Dzień 1</button>
  <button onclick="showDay(2)">Dzień 2</button>
  <button onclick="showDay(3)">Dzień 3</button>
  <button onclick="showDay(4)">Dzień 4</button>
  <button onclick="showDay(5)">Dzień 5</button>
</div>

<div id="map"></div>

<div class="compass" id="compass">
  <svg viewBox="0 0 100 100">
    <circle cx="50" cy="50" r="48"/>
    <polygon points="50,12 45,50 50,45 55,50" fill="red"/>
    <polygon points="50,88 45,50 50,55 55,50" fill="blue"/>
  </svg>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
var map = L.map('map').setView([52.237, 21.017], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '&copy; OpenStreetMap contributors'
}).addTo(map);

var pointsData = [];
var currentDay = 1;
var currentIndex = 0;
var markers = [];
var userMarker = null;

// Wczytanie punktów z JSON
fetch('punkty.json')
  .then(response => {
    if (!response.ok) throw new Error("HTTP error " + response.status);
    return response.json();
  })
  .then(data => {
    pointsData = data;
    showDay(1); // startowy dzień
  })
  .catch(err => console.error("Błąd wczytywania punktów:", err));

// Funkcja pokazująca punkty dnia
function showDay(day){
  if(pointsData.length === 0) return;
  currentDay = day;
  currentIndex = 0;

  markers.forEach(m => map.removeLayer(m));
  markers = [];

  var dayPoints = pointsData.filter(p => p.day === day);
